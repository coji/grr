# ほたる日記 - UX デザイン仕様書

## コンセプト

**ほたる日記**は、日々の気持ちを記録し、ペルソナ「ほたる」が温かく寄り添うSlack日記アプリです。

### ペルソナ：ほたる

- 夏の夜、静かに光を灯す蛍のような存在
- 長い間、人々が自分の気持ちと向き合う様子を見守ってきた
- 特徴：
  - 急かさず、判断せず、ただ傍らにいる
  - 一人ひとりの心の灯りを尊重する
  - 言葉にならない気持ちも沈黙も受け止める
  - 小さな変化や成長を丁寧に見つめる

## 主要な機能とフロー

### 1. リマインダー送信（自動）

**タイミング:** 毎日 22:00 JST

**対象ユーザー:**

- 過去に日記エントリがあるユーザー
- 当日まだエントリがない場合のみ

**送信方法:**

- ユーザーの最後に使用したチャンネルに投稿
- ユーザーをメンションして、ほたるからの優しいリマインダーメッセージ（2-3文、60文字以内）

**自動アクション:**

- メッセージに気分選択用のリアクションを自動追加:
  - 😄 ほっと安心
  - 😐 ふつうの日
  - 😫 おつかれさま

**初回ユーザー:**

- 過去のエントリがない新規ユーザーはスキップ
- 手動で `@ほたる` メンションして開始する必要がある

---

### 2. 気分の記録（リアクション）

**トリガー:** リマインダーメッセージへのリアクション追加

**気分の選択肢:**

| 絵文字 | ラベル       |
| ------ | ------------ |
| 😄     | ほっと安心   |
| 😐     | ふつうの日   |
| 😫     | おつかれさま |

**動作:**

1. ユーザーがリアクションを付ける
2. 気分が記録される
3. 初回の気分記録時のみ、スレッドで確認メッセージを送信:
   ```
   ほたるが今日のきもち「[ラベル]」をそっと受け取ったよ。いつもおつかれさま。
   ```

**リアクション削除:**

- リアクションを外すと気分の記録も削除される

---

### 3. 詳細の記録（スレッド投稿）

**トリガー:** リマインダーメッセージのスレッドにメッセージ投稿

**動作:**

1. ユーザーがスレッドにメッセージを書く
2. メッセージがスレッド履歴として記録される（複数メッセージは `---` で区切って保存）
3. 35%の確率で、ほたるがメッセージの内容に応じたサポートリアクションを付ける

**記録の仕組み:**
- スレッド内のすべてのメッセージが時系列で保存される
- メンション返信時に、スレッド全体の文脈が利用される

**サポートリアクション候補:**

- sparkles ✨
- heart ❤️
- hugging_face 🤗
- sunny ☀️
- blush 😊
- stars ⭐

---

### 4. メンション返信（インタラクティブ対話）

**トリガー:** `@ほたる` でメンション

#### 4.1. 新規メンション（スレッド外）

**動作:**

1. 新規エントリが作成される
2. メンション内容がスレッドの最初のメッセージとして記録される
3. ほたるがメッセージ内容と気分を踏まえて、温かく返信する（2-3文、120文字以内）
4. ユーザーをメンションしてスレッドに投稿
5. メンションメッセージに内容に応じたサポートリアクションを付ける

#### 4.2. スレッド内メンション

**動作:**

1. メンション内容がスレッド履歴に追記される
2. ほたるが**スレッド全体の会話履歴**と気分を踏まえて、文脈に沿った返信をする（2-3文、120文字以内）
3. スレッドで返信
4. メンションメッセージに内容に応じたサポートリアクションを付ける

**重要:** ほたるはスレッド内のすべての会話を記憶しているため、過去のやり取りを踏まえた自然な対話が可能です

---

## 既知の課題・改善点

1. **初回ユーザーの対応**
   - リマインダーは過去のエントリがあるユーザーのみ
   - 新規ユーザーは手動で `@ほたる` メンションして開始

2. **チャンネル選択**
   - ユーザーが最後に使用したチャンネルに送信
   - チャンネル変更の明示的な方法がない

3. **1日複数エントリ**
   - 複数エントリ可能だが、リマインダーは1日1回のみ
   - 既存エントリがある場合はリマインダーをスキップ
